{% extends "base.html" %}

{% block meta_block %}
<meta name="csrf-token" content="{{ csrf_token() }}">
{% endblock %}

{% block css_block %}
<!-- Gallery css -->
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/gallery.css') }}">
{% endblock %}

{% block middle_nav_options %}
<div class="main-search-options">
	<form class="search-form" action="">
		<input placeholder="Search for image by name/tag/image id" type="text" class="search-input" id="image-search-input">
		<button type="submit" class="search-submit"><i class="fa fa-search"></i></button>
	</form>
</div>
{% endblock %}

{% block content %}
{% if image|length == 0 %}
<div class="no-gallery-container">
	<div class="no-image">
		<span>No images uploaded.</span>
	</div>
</div>
{% else %}
<div class="gallery-container">
	{% import 'imager/macros/gallery_section.html' as gallery %}
	{{ gallery.gallery_modal() }}

	<!-- Image Container -->
	<div class="image-container">
		{% set metric_data = {
			'is_anon': current_user.is_anonymous,
			'total_score': image.voter_count["total"],
			'image_id': image.file_id,
			'personal_vote': image.personal_vote,
			'login_url': url_for('auth.login'),
			'upvote_link': url_for('imager.upvote_counter'),
			'downvote_link': url_for('imager.downvote_counter')
		} %}

		<div class="image-metric">
		{{ gallery.vote_section(metric_data) }}
		</div>
		<div class="image-section">
			<!-- Image Details -->
			<div class="image-details">
				<div class="image-title">
					<span>{{image.title}}</span>
				</div>

				<div class="image-uploader">
					<span>
						Uploaded by: <a href="{{ url_for('imager.load_images_by_username', username=image.uploaded_by) }}">{{image.uploaded_by}}</a>
					</span>
				</div>
			</div>

			<div class="image-panel" id="image-panel" onclick="load_picture_modal(this)">
				<img src="{{ url_for('imager.load_image_by_id', image_id=image.file_id) }}" alt="{{image.title}}">
			</div>
		</div>
	</div>
</div>
{% endif %}
{% endblock %}

{% block js_block %}
<script type="text/javascript" src="{{ url_for('static', filename='js/gallery.js') }}"></script>
{% endblock %}