{% extends "base.html" %}


{% block css_block %}
<!-- API css -->
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/api.css') }}">
{% endblock %}

{% block content %}
<div class="api-container">
	<div class="api-section">
		<h3>API Doc</h3>
		<a href="#introduction">Introduction</a>
		<a href="#app-creation">Creating an App</a>
		<a href="#authorization">Authorization</a>
	</div>
	<div class="api-content">
		<h1>API</h1>
		<section id="introduction">
			<h2>Introduction</h2>
			<p>
				This is version 1.0 of the API and is a RESTful API based on HTTP requests and JSON responses. It gives the user the ability to do many of the functionalities that they would be able to do on the website through various API endpoints.
			</p>
			<p>
				It uses <a href="https://datatracker.ietf.org/doc/html/rfc6749" target="_blank">OAuth 2.0</a> which means all requests will need to be encrypted and sent via HTTPS for security reasons. OAuth 2.0 access requests are initiated by the client (Third-Party application) e.g mobile phone, website etc and may require the user(Resource Owner) to grant them access.
			</p>
		</section>

		<section id="app-creation">
			<h2>Creating an App/Registration</h2>
			<p>
				Before you can begin, using the API you will need to first <a href="{{ url_for('api.create_client') }}">register</a> a new application (Client) with server. When registering a new app you need to put basic information such as application name and optionally a redirect URI to be used for redirecting users to other pages, websites ot mobile apps where required. 
			</p>
			<p>
				In addition to the above information, OAuth 2.0 requires one or more Authorization Grant to be specified for creating an app. An Authorization Grant is a credential representing the Resource Owner's (Users) authorization (to access its protected resources) used by the client (Third-Party application) to obtain an access token, they include the following (refer to OAuth documentation above for more information):
				<ol>
					<li><b>Authorization Code</b>: Used for applications running on a web server, browser-based and mobile apps, may require Redirect URI to be used to redirect Resource Owner (User) to an Authorization Server which in turn directs them back to the client with the authorization code.</li>
					<li><b>Password</b>: Used for apps requiring only username and password for logging (i.e for first-party apps).</li>
					<li><b>Client Credentials</b>: Used for application access without a user present, typically when the client is acting on its own behalf or is requesting access to protected resources based on an authorization previously arranaged with the authorization server.</li>
				</ol>

				Lastly there's the client authentication methods, this determines how the client will communicate with the authorization server after the app is created. After creating an app, two tokens will be created <b>client_id</b> and possibly a <b>client_secret</b> if not none. They include the following options:
				<ol>
					<li><b>client_secret_post</b>:Both client_id and client_secret tokens are required to be presented as a parameter of any request to the Authorization server where they'll be checked if they're valid for that specific client.
					</li>

					<li><b>client_secret_basic</b>:
						Here a string is created joining the client_id and client_secret for example: "{client_id}:{client_secret}". Next the string will be encoded with <a href="https://tools.ietf.org/html/rfc4648" target="_blank">BASE64</a>. Finally, embed the BASE64 encoded string in the Authorization header in a token request for example: Authorization: Basic {BASE64-encoded Credentials}
					</li>

					<li><b>none</b>: Client authentication is not required so any request will go through.</li>
				</ol>
			</p>
		</section>

		<section id="authorization">
			<h2>Authorization</h2>
			<p>
				Once the application is registered, the service will issue client credentials in the form of a <b>client_id</b> and a <b>client_secret</b>. client_id is a publicly exposed string that's used by the service API to identify the application, and is also used to build authorization URLs that are presented to users. The client_secret however is used to authenticate the identity of the application to the service API when the application requests to access a user's account, and must be kept private between the application and the API.
			</p>

			<p>
				Using the client_id and possibly the client_secret the client requires to obtain the following before being able to access the resource server(API):
				<ul>
					<li>
						<b>Access Token</b>
					</li>
					<p>
						The access token is required for any client request to be able to  successfully access protected resources from the resource source(API), and will need to be embeded in any request's header. The access token is expected to expire after a period of time.
					</p>

					<li>
						<b>Refresh Token</b>
					</li>
					<p>
						The refresh token is used to obtain new access tokens once the access tokens have expired, where it is long lasting.
					</p>
				</ul>
			</p>

			<p>
				The following steps are needed in the case where an <b>Authorization grant type</b> is used for a client to be authorized to access the resource server (API):
				<ol>
					<li>The client requests authorization to access service resources from the user.</li>
					<li>If the user authorized the request, the application receives an authorization grant.</li>
					<li>The client requests an access token from the authorization server by presenting authentication of its own identity, and the authorization grant</li>
					<li>If the application identity is authenticated and the authorization grant is valid, the authorization server issues an access token to the client. Authorization is complete.</li>
					<li>The client requests the resource from the resource server (API) and presents the access token for authentication.</li>
					<li>If the access token is valid, the resource server(API) serves the resource to the client.</li>
				</ol>
			</p>

			<p>
				The following steps are needed in the case where an <b>Client Credentials</b> grant type:
				<ol>
					<li>The application requests and access token by sending its credentials, its <b>client_id</b> and possibly its <b>client_secret</b> to the authorization server.</li>
					<li>If the application credentials check out, the authorization server returns an access token to the application.</li>
					<li>Now the application is authorized to use its own account.</li>
				</ol>
			</p>

			<p>
				The following steps are needed in the case for <b>Pasword</b> grant type:
				<ol>
					<li>The application requests an access token using users credentials as parameters and including <b>client_id</b> and <b>client_secret</b> to the authorization server.</li>
					<li>If the user credentials check out, the authorization server returns an access token to the application.</li>
					<li>Now the application is authorized to use users account.</li>
				</ol>
			</p>
		</section>
	</div>
</div>

{% endblock %}